function [p1,p2,p3]=Hlvec(plane1,plane2,plane3)
global blksize;
if(blksize==8)
Vplane1=blkproc(plane1,[blksize blksize],@Hilbert8Scan);
end
if(blksize==16)
Vplane1=blkproc(plane1,[blksize blksize],@Hilbert16Scan);
end
reshaped=reshape(Vplane1',blksize*blksize,[]);
pp1=reshaped';
%%%remove last run of zero%%%%%%%%
for i=1:size(pp1,1)
  p1{i,:}=remove_run0(pp1(i,:));
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
if(blksize==8)
Vplane2=blkproc(plane2,[blksize blksize],@Hilbert8Scan);
end
if(blksize==16)
Vplane2=blkproc(plane2,[blksize blksize],@Hilbert16Scan);
end
reshaped=reshape(Vplane2',blksize*blksize,[]);
pp2=reshaped';
%%%remove last run of zero%%%%%%%%
for i=1:size(pp2,1)
  p2{i,:}=remove_run0(pp2(i,:));
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
if(blksize==8)
Vplane3=blkproc(plane3,[blksize blksize],@Hilbert8Scan);
end
if(blksize==16)
Vplane3=blkproc(plane3,[blksize blksize],@Hilbert16Scan);
end
reshaped=reshape(Vplane3',blksize*blksize,[]);
pp3=reshaped';
%%%remove last run of zero%%%%%%%%
for i=1:size(pp3,1)
  p3{i,:}=remove_run0(pp3(i,:));
end

end

%%
function vec=Hilbert8Scan(blk)


vec=[blk(1,1) blk(1,2) blk(2,2) blk(2,1) blk(3,1) blk(4,1) blk(4,2) blk(3,2) blk(3,3) blk(4,3) blk(4,4) blk(3,4)...
      blk(2,4) blk(2,3) blk(1,3) blk(1,4) blk(1,5) blk(2,5) blk(2,6) blk(1,6) blk(1,7) blk(1,8) blk(2,8) blk(2,7)...
      blk(3,7) blk(3,8) blk(4,8) blk(4,7) blk(4,6) blk(3,6) blk(3,5) blk(4,5) blk(5,5) blk(6,5) blk(6,6) blk(5,6)...
	  blk(5,7) blk(5,8) blk(6,8) blk(6,7) blk(7,7) blk(7,8) blk(8,8) blk(8,7) blk(8,6) blk(7,6) blk(7,5) blk(8,5)...
      blk(8,4) blk(8,3) blk(7,3) blk(7,4) blk(6,4) blk(5,4) blk(5,3) blk(6,3) blk(6,2) blk(5,2) blk(5,1) blk(6,1)...
	  blk(7,1) blk(7,2) blk(8,2) blk(8,1)];
end
%%
function vec=Hilbert16Scan(blk);

vec=[blk(1,1) blk(1,2) blk(2,2) blk(2,1) blk(3,1) blk(4,1) blk(4,2) blk(3,2) blk(3,3) blk(4,3) blk(4,4) blk(3,4)...
    blk(2,4) blk(2,3) blk(1,3) blk(1,4) blk(1,5) blk(2,5) blk(2,6) blk(1,6) blk(1,7) blk(1,8) blk(2,8) blk(2,7)...
    blk(3,7) blk(3,8) blk(4,8) blk(8,7) blk(4,6) blk(3,6) blk(3,5) blk(4,5) blk(5,5) blk(6,5) blk(6,6) blk(5,6)...
	blk(5,7) blk(5,8) blk(6,8) blk(6,7) blk(7,7) blk(7,8) blk(8,8) blk(8,7) blk(8,6) blk(7,6) blk(7,5) blk(8,5)...
    blk(8,4) blk(8,3) blk(7,3) blk(7,4) blk(6,4) blk(5,4) blk(5,3) blk(6,3) blk(6,2) blk(5,2) blk(5,1) blk(6,1)...
	blk(7,1) blk(7,2) blk(8,2) blk(8,1) blk(9,1) blk(10,1) blk(10,2) blk(9,2) blk(9,3) blk(9,4) blk(10,4) blk(10,3) ...
	blk(11,3) blk(11,4) blk(12,4) blk(12,3) blk(12,2) blk(11,2) blk(11,1) blk(12,1) blk(13,1) blk(13,2) blk(14,2) blk(14,1)...
    blk(15,1) blk(16,1) blk(16,2) blk(15,2) blk(15,3) blk(16,3) blk(16,4) blk(15,4) blk(14,4) blk(14,3) blk(13,3) blk(13,4)...
    blk(13,5) blk(13,6) blk(14,6) blk(14,5) blk(15,5) blk(16,5) blk(16,6) blk(15,6) blk(15,7) blk(16,7) blk(16,8) blk(15,8)... 
    blk(14,8) blk(14,7) blk(13,7) blk(13,8) blk(12,8) blk(11,8) blk(11,7) blk(12,7) blk(12,6) blk(12,5) blk(11,5) blk(11,6)  ...
	blk(10,6) blk(10,5) blk(9,5) blk(9,6) blk(9,7) blk(10,7) blk(10,8) blk(9,8) blk(9,9) blk(10,9) blk(10,10) blk(9,10)  ...
	blk(9,11) blk(9,12) blk(10,12) blk(10,11) blk(11,11) blk(11,12) blk(12,12) blk(12,11) blk(12,10) blk(11,10) blk(11,9) blk(12,9)...
    blk(13,9) blk(13,10) blk(14,10) blk(14,9) blk(15,9) blk(16,9) blk(16,10) blk(15,10) blk(15,11) blk(16,11) blk(16,12) blk(15,12) ...
	blk(14,12) blk(14,11) blk(13,11) blk(13,12) blk(13,13) blk(13,14) blk(14,14) blk(14,13) blk(15,13) blk(16,13) blk(16,14) blk(15,14)...
    blk(15,15) blk(16,15) blk(16,16) blk(15,16) blk(14,16) blk(14,15) blk(13,15) blk(13,16) blk(12,16) blk(11,16) blk(11,15) blk(12,15)...
    blk(12,14) blk(12,13) blk(11,13) blk(11,14) blk(10,14) blk(10,13) blk(9,13) blk(9,14) blk(9,15) blk(10,15) blk(10,16) blk(9,16) ...
	blk(8,16) blk(8,15) blk(7,15) blk(7,16) blk(6,16) blk(5,16) blk(5,15) blk(6,15) blk(6,14) blk(5,14) blk(5,13) blk(6,13) ...
    blk(7,13) blk(7,14) blk(8,14) blk(8,13) blk(8,12) blk(7,12) blk(7,11) blk(8,11) blk(8,10) blk(8,9) blk(7,9) blk(7,10)  ...
    blk(6,10) blk(6,9) blk(5,9) blk(5,10) blk(5,11) blk(6,11) blk(6,12) blk(5,12) blk(4,12) blk(3,12) blk(3,11) blk(4,11)...
    blk(4,10) blk(4,9) blk(3,9) blk(3,10) blk(2,10) blk(2,9) blk(1,9) blk(1,10) blk(1,11) blk(2,11) blk(2,12) blk(1,12)...
    blk(1,13) blk(1,14) blk(2,14) blk(2,13) blk(3,13) blk(4,13) blk(4,14) blk(3,14) blk(3,15) blk(4,15) blk(4,16) blk(3,16)...
    blk(2,16) blk(2,15) blk(1,15) blk(1,16)];
end
